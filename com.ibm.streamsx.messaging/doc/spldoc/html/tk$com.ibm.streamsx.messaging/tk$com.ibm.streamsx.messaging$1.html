<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Developing and running applications that use the Messaging Toolkit"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_page"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>Developing and running applications that use the Messaging Toolkit</title>
</head>
<body id="spldoc_page">


<h1 class="title topictitle1">Developing and running applications that use the Messaging Toolkit</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Messaging Toolkit Doc</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.messaging.html">com.ibm.streamsx.messaging 5.1.0</a> &gt; Developing and running applications that use the Messaging Toolkit</p>

</div>


<div class="section">
<p class="p">To create applications that use the Messaging Toolkit, you must configure either Streams Studio or the SPL compiler to be aware of the location of the toolkit. 
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Before you begin
</h2>

<div class="p">
<ul class="ul">
<li class="li"> Install IBM InfoSphere Streams.  Configure the product environment variables by entering the following command: 
<pre class="pre codeblock">
  source product-installation-root-directory/4.0.0.0/bin/streamsprofile.sh
</pre>

</li>

<li class="li"> Install a supported version of WebSphere MQ Client, Apache ActiveMQ and XMS client on the same machine as InfoSphere Streams.       WebSphere MQ Server might or might not be on the same machine.  
<p class="p">  For Kafka and MQTT, the toolkit ships with a set of required clients, and therefore this configuration   is not needed.
</p>

<div class="p">
<ul class="ul">
<li class="li"> Apache ActiveMQ
<ul class="ul">
<li class="li"> The <tt class="ph tt">JMSSource</tt> and <tt class="ph tt">JMSSink</tt> operators support Apache ActiveMQ 5.7 and up.
<ul class="ul">
<li class="li"> The Apache ActiveMQ libraries must be installed on same machine as IBM InfoSphere Streams         because the <tt class="ph tt">JMSSink</tt> and <tt class="ph tt">JMSSource</tt> operators require the libraries that are installed with IBM InfoSphere Streams.         However, the ActiveMQ instance to which a message is sent can be a different machine.          You must set the <strong class="ph b">STREAMS_MESSAGING_AMQ_HOME</strong> environment variable to the location where Apache ActiveMQ is installed. For example: 
<pre class="pre codeblock">
  export STREAMS_MESSAGING_AMQ_HOME="/home/streamsuser/ApacheActiveMQ"
</pre>

</li>

</ul>
</li>

</ul>
</li>

<li class="li"> WebSphere MQ Server
<ul class="ul">
<li class="li"> The <tt class="ph tt">JMSSource</tt>, <tt class="ph tt">JMSSink</tt>, <tt class="ph tt">XMSSource</tt> and <tt class="ph tt">XMSSink</tt> operators support WebSphere MQ v7.5 and v8.0.</li>

<li class="li"> The <tt class="ph tt">XMSSource</tt> and <tt class="ph tt">XMSSink</tt> operators require that the IBM Message Service Client (XMS) for C/C++ is installed.
<ul class="ul">
<li class="li"> You can download the IBM Message Service client for C/C++ from IBM Support Portal          (<a class="xref" href="http://www.ibm.com/support/docview.wss?uid=swg24007092">http://www.ibm.com/support/docview.wss?uid=swg24007092</a>).</li>

<li class="li"> The XMS client must be installed on the hosts where the XMS operators can be run.    </li>

</ul>
      You must set the <strong class="ph b">XMS_HOME</strong> environment variable to the installation location of XMS Client.</li>

<li class="li"> The <tt class="ph tt">JMSSource</tt> and <tt class="ph tt">JMSSink</tt> operators require the WebSphere MQ Client libraries for Java if the messaging provider is WebSphere MQ.
<ul class="ul">
<li class="li"> The WebSphere MQ Client libraries must be installed on the hosts where the JMS operators can be run.         You must set the <strong class="ph b">STREAMS_MESSAGING_WMQ_HOME</strong> environment variable to the location where WebSphere MQ is installed.          For example:
<pre class="pre codeblock">
  export STREAMS_MESSAGING_WMQ_HOME="/opt/mqm"
</pre>

</li>

</ul>
</li>

</ul>
</li>

</ul>

</div>
</li>

</ul>

</div>

</div>

<div class="section"><h2 class="title sectiontitle">About this task
</h2>

<p class="p">After the location of the toolkit is communicated to the compiler, the SPL artifacts that are specified in the toolkit can be used by an application. The application can include a use directive to bring the necessary namespaces into scope. Alternatively, you can fully qualify the operators that are provided by toolkit with their namespaces as prefixes.
</p>

</div>

<div class="section"><h2 class="title sectiontitle">Procedure
</h2>

<div class="p">
<ol class="ol">
<li class="li"> Review the list of restrictions for the InfoSphere Streams specialized toolkits in the product documentation.    For example, the <tt class="ph tt">XMSSource</tt> and <tt class="ph tt">XMSSink</tt> operators are not supported on POWER7 or POWER 8 systems. </li>

<li class="li"> Verify that the appropriate environment variables are set for the messaging systems that you use.
<ul class="ul">
<li class="li"> If you use <tt class="ph tt">JMSSink</tt> or <tt class="ph tt">JMSSource</tt> operators to connect to WebSphere MQ or Apache ActiveMQ systems,      set <strong class="ph b">STREAMS_MESSAGING_WMQ_HOME</strong> or <strong class="ph b">STREAMS_MESSAGING_AMQ_HOME</strong> respectively.</li>

<li class="li"> If you use <tt class="ph tt">XMSSink</tt> or <tt class="ph tt">XMSSource</tt> operators to connect to WebSphere MQ messaging systems,      set <strong class="ph b">XMS_HOME</strong>, <strong class="ph b">MQ_HOME</strong>, and <strong class="ph b">LD_LIBRARY_PATH</strong>.</li>

</ul>
</li>

<li class="li"> Configure the SPL compiler to find the toolkit root directory. Use one of the following methods:
<ul class="ul">
<li class="li"> Set the <strong class="ph b">STREAMS_SPLPATH</strong> environment variable to the root directory of a toolkit or multiple toolkits (with : as a separator).     For example:
<pre class="pre codeblock">
  export STREAMS_SPLPATH=$STREAMS_INSTALL/toolkits/com.ibm.streamsx.messaging
</pre>

</li>

<li class="li"> Specify the <strong class="ph b">-t</strong> or <strong class="ph b">--spl-path</strong> command parameter when you run the <strong class="ph b">sc</strong> command. For example:
<pre class="pre codeblock">
  sc -t $STREAMS_INSTALL/toolkits/com.ibm.streamsx.messaging -M MyMain
</pre>

    where MyMain is the name of the SPL main composite.     <strong class="ph b">Note</strong>: These command parameters override the <strong class="ph b">STREAMS_SPLPATH</strong> environment variable.</li>

<li class="li"> Add the toolkit location in InfoSphere Streams Studio.</li>

</ul>
</li>

<li class="li"> Develop your application. To avoid the need to fully qualify the operators, add a use directive in your application. 
<ul class="ul">
<li class="li"> For example, you can add the following clause in your SPL source file:
<pre class="pre codeblock">
  use com.ibm.streamsx.messaging.jms::*;
  use com.ibm.streamsx.messaging.mqtt::*;
  use com.ibm.streamsx.messaging.xms::*;
  use com.ibm.streamsx.messaging.kafka::*;
</pre>

    You can also specify a use clause for individual operators by replacing the asterisk (*) with the operator name. For example: 
<pre class="pre codeblock">
  use com.ibm.streamsx.messaging.jms::JMSSink;
  use com.ibm.streamsx.messaging.mqtt::MQTTSink; 
  use com.ibm.streamsx.messaging.xms::XMSSource;
  use com.ibm.streamsx.messaging.kafka::KafkaConsumer;
</pre>

</li>

</ul>
</li>

<li class="li"> Build your application.  You can use the <strong class="ph b">sc</strong> command or Streams Studio.  </li>

<li class="li"> Start the InfoSphere Streams instance. </li>

<li class="li"> Run the application. You can submit the application as a job by using the <strong class="ph b">streamtool submitjob</strong> command or by using Streams Studio. </li>

</ol>

</div>

</div>

</div>


</body>
</html>