<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Examples"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_page"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>Examples</title>
</head>
<body id="spldoc_page">


<h1 class="title topictitle1">Examples</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Messaging Toolkit Doc</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.messaging.html">com.ibm.streamsx.messaging 5.1.0</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.messaging.jms.html">com.ibm.streamsx.messaging.jms</a> &gt; <a class="xref" href="op$com.ibm.streamsx.messaging.jms$JMSSink.html">JMSSink</a> &gt; Examples</p>

</div>


<div class="section">
<p class="p">This example show the use of multiple JMSSink operators with different parameter combinations.
</p>

<div class="p">
<pre class="pre codeblock">
composite Main {
graph

stream &lt;int32 id, rstring fname, rstring lname&gt;
MyPersonNamesStream  = Beacon()
{
param
	iterations:10u;
}

// JMSSink operator with connections document in the default directory ../etc/connections.xml
// (relative to the data directory)
() as  MySink1 = JMSSink( MyPersonNamesStream )
{
param
	connection : "amqConn";	
	access     : "amqAccess";
}

// JMSSink operator with fully qualified name of connections document
() as  MySink2 = JMSSink( MyPersonNamesStream )
{
param
	connectionDocument   : "/home/streamsuser/connections/JMSconnections.xml";
	connection           : "amqConn";
	access               : "amqAccess";
}

// JMSSink operator with optional output error port specified
stream &lt;tuple&lt; int32 id, rstring fname, rstring lname&gt; inTuple, rstring errorMessage&gt;
MySink3  = JMSSink(MyPersonNamesStream )
{
param
	connection : "amqConn";	
	access     : "amqAccess";
}
// JMSSink operator with reconnectionPolicy specified as  NoRetry
() as  MySink4 = JMSSink( MyPersonNamesStream )
{
param
	connection         : "amqConn";
	access             : "amqAccess";
	reconnectionPolicy : "NoRetry";
}

// JMSSink operator with optional period and reconnectionPolicy specified
() as  MySink5 = JMSSink( MyPersonNamesStream )
{
param
	connection: "amqConn";	
	access: "amqAccess";
	reconnectionPolicy : "InfiniteRetry";
	period: 1.20;
}
// JMSSink operator with reconnectionPolicy specified as BoundedRetry
() as  MySink6 = JMSSink( MyPersonNamesStream )
{
param
	connection: "amqConn";	
	access: "amqAccess"; 
	reconnectionPolicy : "BoundedRetry";
	reconnectionBound : 2;
	period: 1.20;
}
}
</pre>


</div>

<p class="p">The following example shows a sample connections.xml file:
</p>

<div class="p">
<pre class="pre codeblock">
&lt;st:connections 	xmlns:st="http://www.ibm.com/xmlns/prod/streams/adapters"
					xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;

&lt;connection_specifications&gt;
	&lt;connection_specification name="amqConn"&gt;
	 &lt;JMS initial_context="org.apache.activemq.jndi.ActiveMQInitialContextFactory"
		provider_url = "tcp://machine1.com:61616"
		connection_factory="ConnectionFactory"/&gt;
	&lt;/connection_specification&gt;
&lt;/connection_specifications&gt;

&lt;access_specifications&gt;
	&lt;access_specification name="amqAccess"&gt;
		&lt;destination identifier="dynamicQueues/MapQueue" message_class="bytes" /&gt;
			&lt;uses_connection connection="amqConn"/&gt;
			&lt;native_schema&gt;
				&lt;attribute name="id" type="Int" /&gt;
				&lt;attribute name="fname" type="Bytes" length="15" /&gt;
				&lt;attribute name="lname" type="Bytes" length="20" /&gt;
				&lt;attribute name="age" type="Int" /&gt;
				&lt;attribute name="gender" type="Bytes" length="1" /&gt;
				&lt;attribute name="score" type="Float" /&gt;
				&lt;attribute name="total" type="Double" /&gt;
			&lt;/native_schema&gt;
	&lt;/access_specification&gt;
&lt;/access_specifications&gt;
&lt;/st:connections&gt;
</pre>


</div>

</div>

</div>


</body>
</html>